{% extends 'base.html' %}

{% block title %}Department Dashboard - Drishti Platform{% endblock %}

{% block content %}
<div style="max-width: 1200px; margin: 0 auto;">
    <h2 style="margin-bottom: 2rem;">Department Dashboard</h2>

    <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
        <div class="glass-card" style="text-align: center;">
            <h3 style="font-size: 2rem; color: var(--primary);">{{ stats.total }}</h3>
            <p style="color: #cbd5e1;">Total Complaints</p>
        </div>
        <div class="glass-card" style="text-align: center;">
            <h3 style="font-size: 2rem; color: #ef4444;">{{ stats.pending }}</h3>
            <p style="color: #cbd5e1;">Pending</p>
        </div>
        <div class="glass-card" style="text-align: center;">
            <h3 style="font-size: 2rem; color: #10b981;">{{ stats.resolved }}</h3>
            <p style="color: #cbd5e1;">Resolved</p>
        </div>
    </div>

    <div class="glass-card">
        <h3>Recent Complaints</h3>
        <div style="margin-top: 1rem;">
            {% if recent_complaints %}
            <table style="width: 100%; border-collapse: collapse; color: #cbd5e1;">
                <thead>
                    <tr style="text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <th style="padding: 1rem;">ID</th>
                        <th style="padding: 1rem;">Title</th>
                        <th style="padding: 1rem;">Priority</th>
                        <th style="padding: 1rem;">Status</th>
                        <th style="padding: 1rem;">Assigned To</th>
                        <th style="padding: 1rem;">Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for complaint in recent_complaints %}
                    <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <td style="padding: 1rem;">#{{ complaint.id }}</td>
                        <td style="padding: 1rem;">{{ complaint.title }}</td>
                        <td style="padding: 1rem;">{{ complaint.get_priority_display }}</td>
                        <td style="padding: 1rem;">{{ complaint.get_status_display }}</td>
                        <td style="padding: 1rem;">{{ complaint.assigned_officer.username|default:"Unassigned" }}</td>
                        <td style="padding: 1rem;">
                            <a href="{% url 'complaint_detail' complaint.pk %}" class="btn"
                                style="padding: 0.25rem 0.75rem; font-size: 0.85rem; background: rgba(255,255,255,0.1);">Manage</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <p>No recent complaints.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}